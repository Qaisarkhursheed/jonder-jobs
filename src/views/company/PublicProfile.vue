<template>
  <div class="public-profile">
    <!-- <UserNoteAdd /> -->
    <v-row class="heading mb-5">
      <v-col cols="12" md="9">
        <div class="title">Ã–ffentliches Firmenprofil</div>
        <div class="subtitle">
          Bearbeiten Sie die Informationen, die potenzielle Angestellte sehen
          werden.
        </div>
      </v-col>
      <v-col cols="12" md="3">
        <v-btn
          color="primary"
          height="48"
          class="full-w font-weight-medium main-accept-btn dark-blue"
          @click="viewAsTab"
        >
          <template v-if="viewAs">
            Back to Edit
          </template>
          <template v-else>
            Als Arbeitssuchender ansehen
          </template>
        </v-btn>
      </v-col>
    </v-row>
    <v-row>
      <v-col cols="12" md="4">
        <v-card flat class="public-profile-sidebar rounded-lg pt-5 pb-5">
          <v-tabs
            class="pl-8 pr-8"
            slider-color="#fff"
            vertical
            v-model="tabs.active"
          >
            <v-tab
              class="pt-7 pb-7"
              v-for="tab in tabs.options"
              :key="tab.key"
              :disabled="viewAs"
              slider-color="#0253B3"
            >
              {{ $t('company.profile.' + tab.key) }}
            </v-tab>
          </v-tabs>
        </v-card>
      </v-col>
      <v-col cols="12" md="8">
        <v-card flat class="rounded-lg">
          <v-tabs-items v-model="tabs.active">
            <v-tab-item
              :transition="false"
              v-for="item in tabs.options"
              :key="item.key"
            >
              <v-card flat class="pa-10">
                <template v-if="viewAs">
                  <PublicProfileViewAs :user="user" />
                </template>
                <template v-else>
                  <keep-alive>
                    <component
                      :is="tabComponents[item.key]"
                      @update="handleUpdate"
                      :user="user"
                    >
                    </component>
                  </keep-alive>
                </template>
              </v-card>
            </v-tab-item>
          </v-tabs-items>
        </v-card>
      </v-col>
    </v-row>
  </div>
</template>

<script>
import { mapActions } from "vuex";
import store from "@/store";
import PublicProfileGeneral from "@/components/company/PublicProfileGeneral";
import PublicProfileDetails from "@/components/company/PublicProfileDetails";
import PublicProfileContact from "@/components/company/PublicProfileContact";
import PublicProfileViewAs from "@/components/company/PublicProfileViewAs";
// import UserNoteAdd from "@/components/modals/UserNoteAdd";

export default {
  name: "CompanyPublicProfile",

  components: {
    PublicProfileGeneral,
    PublicProfileDetails,
    PublicProfileContact,
    PublicProfileViewAs,
    // UserNoteAdd
  },

  data() {
    return {
      tabs: {
        active: "details",
        options: [{key: "general", label: 'General'}, {key: "details", label:'Details'}, {key:"contact", label:"Contact"}],
      },
      tabComponents: {
        general: PublicProfileGeneral,
        details: PublicProfileDetails,
        contact: PublicProfileContact,
        viewAs: PublicProfileViewAs,
      },
      viewAs: false,
    };
  },
  methods: {
    ...mapActions("user", ["updateCompany"]),
    updateCompanyOld(input) {
      store.dispatch("user/updateCompany", {
        id: this.user.id,
        data: {
          ...input,
        },
      });
    },
    viewAsTab() {
      this.viewAs = !this.viewAs;
    },
    handleUpdate(input) {
      this.updateCompany(input)
        .then(() => {
          alert("Success");
        })
        .catch((err) => {
          alert(err.data.message);
        });
      //this.updateCompanyUser(formDataCopy);
    },
  },
  computed: {
    user() {
      return store.getters["user/user"];
    },
  },
};
</script>

<style lang="scss" scoped>
.heading {
  font-weight: 600;
  font-size: 32px;
  color: #222222;

  .title {
    font-weight: 600;
    font-size: 32px !important;
    color: #222222;
  }
  .subtitle {
    font-weight: normal;
    font-size: 18px;
    color: #7a7a7a;
  }
}
.v-btn.main-accept-btn {
  background-color: $primary-blue-dark !important;
  color: #fff;
}

@media (min-width: 960px) {
  .public-profile-sidebar {
    height: 450px;
  }
}
</style>
